<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>p5.js 기본 예제</title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.6.0/lib/p5.min.js"></script>
</head>

<body>
    <script>
        let startCaptureButton;
        let vid;

        function setup() {
            createCanvas(640, 480);
            background(220);
            vid = createVideo();
            vid.size(640, 480);

            // Create a button to start the capture
            startCaptureButton = createButton('Start Screen Capture');
            startCaptureButton.position(10, height + 10);
            startCaptureButton.mousePressed(startScreenCapture);
        }

        // The async function to get the screen media stream
        async function startScreenCapture() {
            try {
                const stream = await navigator.mediaDevices.getDisplayMedia({
                    video: true
                });
                console.log("Stream received:", stream); // 스트림이 정상적으로 받아졌는지 확인
                vid.elt.srcObject = stream;
                vid.elt.play();
                vid.hide();
            } catch (err) {
                console.error("Error accessing display media:", err); // 오류 발생 시 출력
            }
        }

        function draw() {
            if (vid) {
                image(vid, 0, 0, width, height);
            }
        }
    </script>
</body>

</html>
